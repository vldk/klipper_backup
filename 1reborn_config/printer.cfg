[include steppers.cfg]
[include mainsail.cfg]
[include playtones.cfg]
[include leds.cfg]
[include macroses.cfg]
[include bltouch.cfg]
[include bedmesh.cfg]
# [include adxl.cfg]

[virtual_sdcard]
path: ~/1reborn_data/gcodes
on_error_gcode:
  CANCEL_PRINT

[pause_resume]

[display_status]

[exclude_object]


[mcu]
# serial: /dev/serial/by-path/platform-5200000.ehci1-controller-usb-0:1.2:1.0
serial: /dev/ttyS3
restart_method: command

[mcu host]
serial: /tmp/klipper_host_mcu



[printer]
kinematics: corexy
max_velocity: 300 #максимальные ускорения
square_corner_velocity: 5.0
max_accel: 5000 #max: 6200
max_accel_to_decel: 2500 #max: 3100
max_z_velocity: 25
max_z_accel: 100

[temperature_sensor mcu_temp]
sensor_type: temperature_mcu
# min_temp: -80
# max_temp: 80

[temperature_sensor orange_pi]
sensor_type: temperature_host
min_temp: 0
max_temp: 90

[input_shaper]
shaper_freq_x: 47.8 #51.2  # frequency for the X mark of the test model
shaper_type_x: mzv
shaper_freq_y: 53.68 #74.8  # frequency for the Y mark of the test model
shaper_type_y: mzv #2hump_ei

[firmware_retraction]
retract_length: 0.6
retract_speed: 20
unretract_extra_length: 0.6
unretract_speed: 20

[heater_bed]
heater_pin: PB4
sensor_type: EPCOS 100K B57560G104F
sensor_pin: PB0 # Смотри пункт 1 в заголовке
min_temp: 0
max_temp: 130
#control: pid
#pid_Kp:65.232 
#pid_Ki:1.330 
#pid_Kd:799.905

#####################################################################
#  Heater Fan + Mother Board Fan
#####################################################################
[heater_fan heater_fan]
pin: PA13 
kick_start_time: 0.4
max_power: 1.0
shutdown_speed: 0.0
heater: extruder
heater_temp: 60.0 ; Shutdown FAN at 30C
fan_speed: 1.0

[heater_fan filter_fan]
pin: PB2 
kick_start_time: 0.4
max_power: 1.0
shutdown_speed: 0.0
heater: heater_bed
heater_temp: 67.0 ; Shutdown FAN at 65C, Do not use for PLA
fan_speed: 0.7

#####################################################################
#  Fan 2x4010 Model FAN
#####################################################################
[fan]
pin: PA14
max_power: 1.0
shutdown_speed: 0
cycle_time: 0.010
hardware_pwm: False
off_below: 0.20
kick_start_time: 0.4


[filament_switch_sensor filament_sensor]
switch_pin: PA1
pause_on_runout: True

#runout_gcode:
#insert_gcode:
#event_delay: 3.0
#pause_delay: 0.5

# [temperature_sensor Closure]
# sensor_type: BME280
# i2c_address: 118
# i2c_bus: i2c2
# i2c_mcu: host
# i2c_bus: i2c.0


# [board_pins]
# aliases:
#     # EXP1 header
#     EXP1_1=PC5,  EXP1_3=PD13,   EXP1_5=PE14, EXP1_7=PD11,  EXP1_9=<GND>,
#     EXP1_2=PE13, EXP1_4=PC6,    EXP1_6=PE15, EXP1_8=PD10,  EXP1_10=<5V>,
#     # EXP2 header
#     EXP2_1=PA6, EXP2_3=PE8,  EXP2_5=PE11, EXP2_7=PE12,  EXP2_9=<GND>,
#     EXP2_2=PA5, EXP2_4=PE10, EXP2_6=PA7,  EXP2_8=<RST>, EXP2_10=<3.3V>

[idle_timeout]
gcode:
   TURN_OFF_HEATERS
   M84             ; disable steppers
timeout: 5400      ;90 min

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [heater_bed]
#*# control = pid
#*# pid_kp = 61.908
#*# pid_ki = 2.074
#*# pid_kd = 461.990
#*#
#*# [extruder]
#*# control = pid
#*# pid_kp = 30.615
#*# pid_ki = 1.744
#*# pid_kd = 134.324
#*#
#*# [bltouch]
#*# z_offset = 0.550
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	0.111928, 0.081511, 0.060678, 0.066511, 0.048178, 0.075678, 0.141928
#*# 	0.013178, 0.033178, 0.005678, -0.034739, -0.054739, -0.050989, 0.004011
#*# 	-0.037239, -0.053072, -0.056822, -0.100572, -0.105572, -0.086405, -0.051405
#*# 	0.039428, -0.003905, -0.033905, -0.041822, -0.015989, -0.034739, -0.019322
#*# 	0.027345, 0.039845, -0.013489, -0.040989, -0.028905, 0.010261, 0.009428
#*# 	0.049428, 0.053178, 0.072761, 0.074428, 0.082761, 0.078178, 0.105678
#*# 	0.157345, 0.142345, 0.144011, 0.141095, 0.146928, 0.172345, 0.229011
#*# tension = 0.2
#*# min_x = 50.0
#*# algo = bicubic
#*# y_count = 7
#*# mesh_y_pps = 2
#*# min_y = 25.0
#*# x_count = 7
#*# max_y = 310.0
#*# mesh_x_pps = 2
#*# max_x = 320.0
#*#
#*# [bed_mesh stock2]
#*# version = 1
#*# points =
#*# 	0.211338, 0.197588, 0.195921, 0.158004, 0.131754, 0.158421, 0.200088
#*# 	0.150088, 0.119671, 0.099254, 0.081754, 0.033421, 0.060088, 0.092588
#*# 	0.090088, 0.065088, 0.035921, -0.001579, -0.008662, 0.000088, 0.062588
#*# 	0.105504, 0.089254, 0.065504, 0.034254, 0.003838, 0.002171, 0.076754
#*# 	0.067588, 0.049671, 0.031338, 0.000088, -0.016162, -0.005329, 0.067588
#*# 	0.079671, 0.079671, 0.080921, 0.060504, 0.047588, 0.065504, 0.123838
#*# 	0.110504, 0.115088, 0.127588, 0.119671, 0.109254, 0.130504, 0.197588
#*# tension = 0.2
#*# min_x = 50.0
#*# algo = bicubic
#*# y_count = 7
#*# mesh_y_pps = 2
#*# min_y = 25.0
#*# x_count = 7
#*# max_y = 310.0
#*# mesh_x_pps = 2
#*# max_x = 320.0
#*#
#*# [bed_mesh glass_old]
#*# version = 1
#*# points =
#*# 	0.274037, 0.224453, 0.240287, 0.258620, 0.170703, 0.235287, 0.225287
#*# 	0.214453, 0.162787, 0.130703, 0.131120, 0.068203, 0.076537, 0.113620
#*# 	0.141953, 0.091120, 0.055703, 0.043620, 0.000287, 0.036537, 0.076537
#*# 	0.190287, 0.134453, 0.119453, 0.095703, 0.032370, 0.061120, 0.091953
#*# 	0.166953, 0.112787, 0.090287, 0.109870, 0.028203, 0.076537, 0.109870
#*# 	0.210703, 0.204037, 0.180287, 0.187370, 0.139870, 0.158620, 0.214870
#*# 	0.191120, 0.188203, 0.183203, 0.172787, 0.153620, 0.194870, 0.226537
#*# tension = 0.2
#*# mesh_x_pps = 2
#*# algo = bicubic
#*# min_x = 40.7
#*# min_y = 6.8
#*# y_count = 7
#*# mesh_y_pps = 2
#*# x_count = 7
#*# max_x = 310.7
#*# max_y = 299.78
#*#
#*# [bed_mesh glass]
#*# version = 1
#*# points =
#*# 	0.114564, 0.102897, 0.142064, 0.124564, 0.126230, 0.070397, 0.115397, 0.111230, 0.144564, 0.123730
#*# 	0.047897, 0.046230, 0.049564, 0.051230, 0.060397, 0.029564, 0.041230, 0.055397, 0.080397, 0.045397
#*# 	0.002064, 0.002897, 0.005397, 0.020397, 0.043730, 0.027897, 0.045397, 0.039564, 0.061230, 0.026230
#*# 	0.002064, -0.006270, -0.007103, 0.012897, 0.028730, 0.004564, 0.006230, 0.027064, 0.029564, -0.026270
#*# 	0.017897, 0.006230, -0.000436, 0.025397, 0.032897, 0.021230, 0.037897, 0.059564, 0.072897, 0.007897
#*# 	0.028730, 0.018730, 0.012064, 0.031230, 0.054564, 0.051230, 0.072897, 0.101230, 0.099564, 0.036230
#*# 	0.009564, 0.000397, 0.003730, 0.015397, 0.016230, 0.022064, 0.039564, 0.078730, 0.094564, 0.037897
#*# 	0.041230, 0.045397, 0.040397, 0.048730, 0.067897, 0.042897, 0.060397, 0.104564, 0.123730, 0.088730
#*# 	0.075397, 0.077897, 0.075397, 0.078730, 0.081230, 0.059564, 0.094564, 0.129564, 0.150397, 0.137897
#*# 	0.073730, 0.101230, 0.108730, 0.122897, 0.131230, 0.111230, 0.134564, 0.164564, 0.191230, 0.196230
#*# tension = 0.2
#*# min_x = 40.7
#*# algo = bicubic
#*# y_count = 10
#*# mesh_y_pps = 2
#*# min_y = 6.8
#*# x_count = 10
#*# max_y = 299.75
#*# mesh_x_pps = 2
#*# max_x = 310.7
#*#
#*# [bed_mesh test1]
#*# version = 1
#*# points =
#*# 	0.172064, 0.172064, 0.179564, 0.197897, 0.218730, 0.162897, 0.141230, 0.163730, 0.181230, 0.161230
#*# 	0.111230, 0.105397, 0.108730, 0.112064, 0.127064, 0.095397, 0.102897, 0.108730, 0.128730, 0.097064
#*# 	0.066230, 0.053730, 0.052064, 0.069564, 0.094564, 0.081230, 0.086230, 0.090397, 0.123730, 0.085397
#*# 	0.061230, 0.040397, 0.035397, 0.045397, 0.064564, 0.047064, 0.050397, 0.068730, 0.082897, 0.032897
#*# 	0.092064, 0.059564, 0.044564, 0.059564, 0.068730, 0.051230, 0.070397, 0.097064, 0.114564, 0.069564
#*# 	0.098730, 0.078730, 0.065397, 0.082064, 0.103730, 0.094564, 0.109564, 0.136230, 0.144564, 0.102897
#*# 	0.072064, 0.052897, 0.046230, 0.050397, 0.052897, 0.045397, 0.065397, 0.110397, 0.128730, 0.086230
#*# 	0.075397, 0.073730, 0.064564, 0.074564, 0.092897, 0.063730, 0.089564, 0.131230, 0.158730, 0.112897
#*# 	0.102897, 0.104564, 0.098730, 0.104564, 0.102064, 0.077897, 0.097897, 0.135397, 0.150397, 0.132897
#*# 	0.096230, 0.118730, 0.125397, 0.148730, 0.162064, 0.129564, 0.138730, 0.173730, 0.191230, 0.188730
#*# tension = 0.2
#*# min_x = 40.7
#*# algo = bicubic
#*# y_count = 10
#*# mesh_y_pps = 2
#*# min_y = 6.8
#*# x_count = 10
#*# max_y = 299.75
#*# mesh_x_pps = 2
#*# max_x = 310.7
